# Pairing Mode - Quick Reference

> **Quick cheatsheet for WhatsApp Pairing Code authentication**

## Basic Setup

```javascript
import { Client } from '@roidev/kachina-md';

const client = new Client({
    loginMethod: 'pairing',
    phoneNumber: '628123456789' // Country code + number, no +
});

client.on('pairing.code', (code) => {
    console.log('Code:', code);
});

await client.start();
```

## Phone Number Formats

```javascript
// âœ… Correct
'628123456789'    // Indonesia
'12025551234'     // USA
'447911123456'    // UK
'919876543210'    // India

// âŒ Wrong
'+628123456789'   // Remove +
'62 812 345 6789' // Remove spaces
'0812345678'      // Add country code
```

## Essential Events

```javascript
// Code generated
client.on('pairing.code', (code) => {
    console.log('Enter in WhatsApp:', code);
});

// Error occurred
client.on('pairing.error', (error) => {
    console.error('Failed:', error.message);
});

// Connected successfully
client.on('ready', (user) => {
    console.log('Connected!', user.name);
});
```

## Configuration Options

```javascript
{
    loginMethod: 'pairing',        // Required: 'pairing'
    phoneNumber: '628123456789',   // Required: Your number
    sessionId: 'my-session',       // Optional: Session name
    browser: ['Bot', 'Chrome', '1.0.0'] // Optional: Browser info
}
```

## Common Patterns

### Environment Variables

```javascript
const client = new Client({
    loginMethod: 'pairing',
    phoneNumber: process.env.PHONE_NUMBER
});
```

```bash
PHONE_NUMBER=628123456789 node bot.js
```

### Retry Logic

```javascript
client.on('pairing.error', async (error) => {
    console.log('Retrying...');
    await new Promise(r => setTimeout(r, 5000));
    await client.start();
});
```

### Save Code to File

```javascript
import fs from 'fs';

client.on('pairing.code', async (code) => {
    await fs.promises.writeFile('code.txt', code);
});
```

### Send to API

```javascript
client.on('pairing.code', async (code) => {
    await fetch('https://api.example.com/pairing', {
        method: 'POST',
        body: JSON.stringify({ code })
    });
});
```

## Troubleshooting

| Problem | Solution |
|---------|----------|
| "Phone number required" | Add `phoneNumber: '...'` |
| "Invalid phone format" | Remove `+`, spaces, use country code |
| Code not showing | Check `loginMethod: 'pairing'` |
| Code expired | Restart bot (60s limit) |
| Already connected | Delete session folder |

## Commands

```bash
# Run basic example
node examples/pairing-bot.js

# Run advanced example
node examples/pairing-advanced.js

# With environment variable
PHONE_NUMBER=628123456789 node bot.js

# Clear session
rm -rf ./session-name
```

## Steps to Connect

1. Start bot â†’ Code generated (8 chars)
2. Open WhatsApp on phone
3. **Settings** â†’ **Linked Devices**
4. **Link a Device** â†’ Enter code
5. Bot connects automatically

## Code Properties

- **Length:** 8 alphanumeric characters
- **Expiration:** 60 seconds
- **Use:** One-time only
- **Format:** Auto-generated by WhatsApp

## Comparison vs QR

| Feature | Pairing | QR |
|---------|---------|-----|
| Phone Number | Required | Not needed |
| GUI | Not required | Required |
| Expiration | 60s | ~20s |
| Remote Setup | Easy | Hard |

## Docker Example

```yaml
# docker-compose.yml
services:
  bot:
    build: .
    environment:
      - PHONE_NUMBER=628123456789
      - LOGIN_METHOD=pairing
    volumes:
      - ./sessions:/app/sessions
```

```javascript
// bot.js
const client = new Client({
    loginMethod: process.env.LOGIN_METHOD,
    phoneNumber: process.env.PHONE_NUMBER,
    sessionId: 'docker-session'
});
```

## Complete Minimal Example

```javascript
import { Client } from '@roidev/kachina-md';

const client = new Client({
    loginMethod: 'pairing',
    phoneNumber: '628123456789'
});

client.on('pairing.code', console.log);
client.on('ready', () => console.log('Ready!'));
client.on('message', async (msg) => {
    if (msg.body === '!ping') {
        await client.sendText(msg.from, 'Pong!');
    }
});

client.start();
```

## Resources

- ğŸ“– [Full Pairing Guide](./PAIRING-MODE.md)
- ğŸ“– [Authentication Methods](./AUTHENTICATION-METHODS.md)
- ğŸ’» [Examples](../examples/)
- ğŸ› [Report Issues](https://github.com/idlanyor/kachina-core/issues)

---

**Tip:** For production, always use environment variables for phone numbers!

```javascript
// âŒ Don't hardcode
phoneNumber: '628123456789'

// âœ… Use env vars
phoneNumber: process.env.PHONE_NUMBER
```
